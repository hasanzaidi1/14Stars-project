<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Welcome to 14 Stars Islamic School, where we empower students through knowledge and Islamic values.">
    <title>14 Stars Islamic School</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <header class="site-header">
        <a class="brand-mark" href="/index.html">14 Stars</a>
        <button class="nav-toggle" type="button" aria-label="Toggle navigation" aria-expanded="false" data-nav-toggle data-target="primary-nav">☰</button>
        <nav class="nav-links" id="primary-nav" role="navigation">
            <a class="nav-link is-active" href="/index.html">Home</a>
            <a class="nav-link" href="#">Classes</a>
            <a class="nav-link" href="/parents/parents_login.html">Parents</a>
            <a class="nav-link" href="/teachers/teachers.html">Teachers</a>
            <a class="nav-link" href="/admin/admin-login.html">Admin</a>
            <a class="nav-link" href="#">Announcements</a>
        </nav>
    </header>

    <main class="stack">
        <section class="hero stack">
            <p class="page-eyebrow">Islamic School Network</p>
            <h1>Learning that nurtures faith & community</h1>
            <p>14 Stars connects parents, students, teachers, and administrators with a single, calm space to coordinate classes and celebrate progress.</p>
            <div class="hero-actions">
                <button class="btn" onclick="window.location.href='/parents/parents_login.html'">Parent Portal</button>
                <button class="btn btn--ghost" onclick="window.location.href='/teachers/teachers.html'">Teacher Login</button>
                <button class="btn btn--secondary" onclick="window.location.href='/admin/admin-login.html'">Admin Access</button>
            </div>
        </section>

        <section class="card stack" id="home-announcements">
            <div>
                <p class="page-eyebrow">Community Updates</p>
                <h2>Announcements &amp; Events</h2>
                <p class="text-muted">Administrators keep this board current so every family stays aligned.</p>
            </div>
            <div class="cards-grid" id="announcementCards" aria-live="polite">
                <article class="card card--muted" data-placeholder>
                    <h3>Loading announcements…</h3>
                    <p>Please hold on while we fetch the latest updates.</p>
                </article>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <p>&copy; 2024 14 Stars Islamic School. All rights reserved.</p>
    </footer>

    <script>
        async function loadHomepageAnnouncements() {
            const container = document.getElementById('announcementCards');
            if (!container) return;

            try {
                const response = await fetch('/announcements/public?limit=3');
                if (!response.ok) throw new Error('Failed to fetch announcements');
                const announcements = await response.json();

                container.innerHTML = '';
                if (!announcements.length) {
                    const empty = document.createElement('article');
                    empty.className = 'card card--muted';
                    empty.innerHTML = '<h3>No announcements yet</h3><p>Check back soon for upcoming events.</p>';
                    container.appendChild(empty);
                    return;
                }

                announcements.forEach((announcement) => {
                    const article = document.createElement('article');
                    article.className = 'card event-card';

                    const title = document.createElement('h3');
                    title.textContent = announcement.title;

                    const body = document.createElement('p');
                    body.textContent = announcement.body;

                    article.appendChild(title);
                    article.appendChild(body);

                    if (announcement.ctaLabel && announcement.ctaUrl) {
                        const action = document.createElement('a');
                        action.href = announcement.ctaUrl;
                        action.textContent = announcement.ctaLabel;
                        action.className = 'btn btn--ghost';
                        action.target = '_blank';
                        action.rel = 'noopener noreferrer';
                        article.appendChild(action);
                    }

                    container.appendChild(article);
                });
            } catch (error) {
                console.error('Unable to load announcements:', error);
                container.innerHTML = '';
                const fallback = document.createElement('article');
                fallback.className = 'card card--muted';
                fallback.innerHTML = '<h3>Announcements unavailable</h3><p>Please refresh to try again.</p>';
                container.appendChild(fallback);
            }
        }

        document.addEventListener('DOMContentLoaded', loadHomepageAnnouncements);
    </script>
    <script src="/scripts/ui.js" defer></script>
</body>
</html>
